webpackJsonp([36],{sZNU:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("gyMJ"),n=e("0xDb"),l={data:function(){return{dataForm:{activityName:"",activityType:"",activityTime:"",status:""},dataList:[],pageIndex:1,pageSize:10,totalPage:0,activityType:[{value:"1",label:"意向收集"},{value:"2",label:"全场优惠券"}],status:[{value:"0",label:"草稿"},{value:"1",label:"未开始"},{value:"2",label:"提报中"},{value:"3",label:"提报结束"},{value:"4",label:"活动进行中"},{value:"5",label:"活动结束"}],dataListLoading:!1,dataListSelections:[],addOrUpdateVisible:!1}},filters:{formatDate:function(t){var a=new Date(t);return Object(n.a)(a,"yyyy-MM-dd hh:mm:ss")}},activated:function(){this.getDataList()},methods:{getDataList:function(){var t=this;this.dataListLoading=!0;var a={activityType:this.dataForm.activityType,activityName:this.dataForm.activityName,activityStartTime:this.dataForm.activityTime[0],activityEndTime:this.dataForm.activityTime[1],status:this.dataForm.status,page:this.pageIndex,limit:this.pageSize};i.a.activity.list(a).then(function(a){var e=a.data;e&&0===e.code?(t.dataList=e.page.list,t.totalPage=e.page.totalCount):(t.dataList=[],t.totalPage=0),t.dataListLoading=!1}).catch(function(){})},sizeChangeHandle:function(t){console.log(t),this.pageSize=t,this.pageIndex=1,this.getDataList()},currentChangeHandle:function(t){this.pageIndex=t,this.getDataList()},addOrUpdateHandle:function(t,a){var e=this;this.$nextTick(function(){t?e.$router.push({name:"intentionCreate",params:{activityId:t,activityType:a}}):e.$router.push({name:"ActivityCreate"})})},deleteHandle:function(t){var a=this;this.$confirm("确认删除该活动吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){i.a.activity.deleteIntention([t]).then(function(t){var e=t.data;e&&0===e.code?a.$alert("操作成功","提示",{confirmButtonText:"确定",type:"success",showClose:!1,callback:function(t){a.getDataList()}}):a.$alert(e.msg,"提示",{confirmButtonText:"确定",type:"warning",showClose:!1})})}).catch(function(){})},goodsHandle:function(t,a){this.$router.push({name:"goodSaudit",params:{activityId:t,activityType:a}})},startHandle:function(t){var a=this,e={umpPlatCouponId:parseInt(t)};i.a.activity.start(e).then(function(t){var e=t.data;e&&0===e.code?(a.$alert("启动成功","提示",{confirmButtonText:"确定",type:"success",showClose:!1,callback:function(t){a.getDataList()}}),console.log(e)):a.$alert(e.msg,"提示",{confirmButtonText:"确定",type:"warning",showClose:!1})}).catch(function(){})},resetForm:function(t){this.$nextTick(function(){this.$refs[t].resetFields()})}}},o={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mod-role"},[e("el-form",{ref:"dataForm",attrs:{inline:!0,model:t.dataForm},nativeOn:{keyup:function(a){if(!("button"in a)&&t._k(a.keyCode,"enter",13,a.key))return null;t.getDataList()}}},[e("el-row",[e("el-form-item",{attrs:{label:"活动名称",prop:"activityName"}},[e("el-input",{attrs:{placeholder:"活动名称",clearable:"",maxlength:"20"},model:{value:t.dataForm.activityName,callback:function(a){t.$set(t.dataForm,"activityName",a)},expression:"dataForm.activityName"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"活动类型",prop:"activityType"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.dataForm.activityType,callback:function(a){t.$set(t.dataForm,"activityType",a)},expression:"dataForm.activityType"}},t._l(t.activityType,function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),e("el-form-item",{attrs:{label:"活动时间",prop:"activityTime"}},[e("el-date-picker",{attrs:{type:"datetimerange","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dataForm.activityTime,callback:function(a){t.$set(t.dataForm,"activityTime",a)},expression:"dataForm.activityTime"}})],1)],1),t._v(" "),e("el-row",[e("el-form-item",{attrs:{label:"活动状态",prop:"status"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.dataForm.status,callback:function(a){t.$set(t.dataForm,"status",a)},expression:"dataForm.status"}},t._l(t.status,function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),e("el-form-item",[e("el-button",{on:{click:function(a){t.getDataList()}}},[t._v("查询")]),t._v(" "),e("el-button",{on:{click:function(a){t.resetForm("dataForm")}}},[t._v("重置")]),t._v(" "),t.isAuth("sys:role:save")?e("el-button",{attrs:{icon:"el-icon-circle-plus-outline",type:"primary"},on:{click:function(a){t.addOrUpdateHandle()}}},[t._v("新增")]):t._e()],1)],1)],1),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.dataList,border:""}},[e("el-table-column",{attrs:{prop:"activityId","header-align":"center",align:"center",width:"80",label:"活动编号"}}),t._v(" "),e("el-table-column",{attrs:{"header-align":"left",align:"left",label:"活动名称"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("router-link",{attrs:{to:{name:"ActivityInfo",params:{activityId:a.row.activityId,activityType:a.row.activityType}}}},[t._v(t._s(a.row.activityName)+"\n        ")])]}}])}),t._v(" "),e("el-table-column",{attrs:{"header-align":"center",align:"center",label:"类型",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(t._s(t.activityType[a.row.activityType-1].label))]}}])}),t._v(" "),e("el-table-column",{attrs:{"header-align":"left",align:"left",label:"时间"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("p",[t._v("提报时间："+t._s(t._f("formatDate")(a.row.reportStartTime))+"—"+t._s(t._f("formatDate")(a.row.reportEndTime)))]),t._v(" "),e("p",[t._v("活动时间："+t._s(t._f("formatDate")(a.row.activityStartTime))+"—"+t._s(t._f("formatDate")(a.row.activityEndTime)))])]}}])}),t._v(" "),e("el-table-column",{attrs:{"header-align":"center",align:"center",label:"活动状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(t._s(t.status[a.row.status].label))]}}])}),t._v(" "),e("el-table-column",{attrs:{fixed:"right","header-align":"center",align:"center",width:"280",label:"操作",fit:"true","class-name":"el-button-op"},scopedSlots:t._u([{key:"default",fn:function(a){return[t.isAuth("activity:activity:all")&&a.row.umpPlatCouponId&&!a.row.couponStart?e("el-button",{attrs:{plain:"",size:"small"},on:{click:function(e){t.startHandle(a.row.umpPlatCouponId)}}},[t._v("启动")]):t._e(),t._v(" "),t.isAuth("activity:activity:all")&&5!=a.row.status?e("el-button",{attrs:{plain:"",size:"small"},on:{click:function(e){t.addOrUpdateHandle(a.row.activityId,a.row.activityType)}}},[t._v("修改")]):t._e(),t._v(" "),t.isAuth("activity:activity:all")&&a.row.status<2?e("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){t.deleteHandle(a.row.activityId)}}},[t._v("删除")]):t._e(),t._v(" "),t.isAuth("activity:activity:all")&&1<a.row.status<5?e("el-button",{attrs:{plain:"",size:"small"},on:{click:function(e){t.goodsHandle(a.row.activityId,a.row.activityType)}}},[t._v("商品管理")]):t._e()]}}])})],1),t._v(" "),e("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,20,50,100],"page-size":t.pageSize,total:t.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.sizeChangeHandle,"current-change":t.currentChangeHandle}})],1)},staticRenderFns:[]},r=e("VU/8")(l,o,!1,null,null,null);a.default=r.exports}});